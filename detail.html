<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exam Details</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://www.gstatic.com/firebasejs/7.20.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.20.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.20.0/firebase-database.js"></script>
</head>
<body>
    <div class="container">
        <h1>Exam Details</h1>
        <div id="examDetails"></div>
        <button id="backBtn">Back to Exams</button>
    </div>

    <script>
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyDIWtVfoGIWQoRVe36v6g6S3slTRRYUAgk",
  authDomain: "quizes-3028d.firebaseapp.com",
  databaseURL: "https://quizes-3028d-default-rtdb.firebaseio.com",
  projectId: "quizes-3028d",
  storageBucket: "quizes-3028d.appspot.com",
  messagingSenderId: "624591251031",
  appId: "1:624591251031:web:e093472f24fdeb29fc2512",
  measurementId: "G-QMZK5Y6769"
};

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        const urlParams = new URLSearchParams(window.location.search);
        const examID = urlParams.get('examID');

        // Load exam details
        database.ref('generatedQuizzes/' + examID).once('value').then(snapshot => {
            const examData = snapshot.val();
            const examDetailsDiv = document.getElementById('examDetails');

            if (examData) {
                examDetailsDiv.innerHTML = `<h2>Subject: ${examData.subject}</h2>
                                             <p>Date: ${examData.date}</p>
                                             <p>Score: ${examData.score}</p>`;
                examData.questions.forEach((q, index) => {
                    const selected = examData.userAnswers ? examData.userAnswers[index] : null;
                    const correct = q.correctAnswer;

                    const resultColor = selected === correct ? 'green' : 'red';
                    const selectedAnswerText = selected !== null ? `Your answer: ${q.options[selected - 1]}` : 'No answer';
                    const correctAnswerText = `Correct answer: ${q.options[correct - 1]}`;
                    const explanation = q.explanation ? `<p>Explanation: ${q.explanation}</p>` : '';

                    const questionDiv = document.createElement('div');
                    questionDiv.innerHTML = `<h3>Question ${index + 1}: ${q.question}</h3>
                                             <p style="color:${resultColor};">${selectedAnswerText} (${correctAnswerText})</p>
                                             ${explanation}`;
                    examDetailsDiv.appendChild(questionDiv);
                });
            } else {
                examDetailsDiv.innerHTML = `<p>No exam data found.</p>`;
            }
        });

        // Back to exams
        document.getElementById('backBtn').onclick = function() {
            window.history.back();
        };
    </script>
</body>
</html>
